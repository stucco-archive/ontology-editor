{
  "description":"The top level of the graph",
  "type":"object",
  "$schema": "http://json-schema.org/draft-03/schema",
  "id": "gov.ornl.sava.stucco/graph",
  "required":false,
  "properties":{
    "mode": {
      "type": "gov.ornl.sava.graphson.normal/graph/mode"
    },
    "edges": {
      "title":"edges",
      "description":"The list of edges in this graph",
      "type":"array",
      "id": "gov.ornl.sava.stucco/graph/edges",
      "required":false,
      "items":[ 
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasAccount",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasAccount",
          "description":"'user' -'has account'-> 'account'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["account"]
            },
            "outVType":{
              "required":true,
              "enum":["user"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/logsInTo",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"logsInTo",
          "description":"'account' -'logsInTo'-> 'host'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["host"]
            },
            "outVType":{
              "required":true,
              "enum":["account"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/runs",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"runs",
          "description":"'host' -'runs'-> 'software'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["software"]
            },
            "outVType":{
              "required":true,
              "enum":["host"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/runsAs",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"runsAs",
          "description":"'software' -'runsAs'-> 'account'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["account"]
            },
            "outVType":{
              "required":true,
              "enum":["software"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasVulnerability",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasVulnerability",
          "description":"'software' -'hasVulnerability'-> 'vulnerability'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["vulnerability"]
            },
            "outVType":{
              "required":true,
              "enum":["software"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/usesAddress",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"usesAddress",
          "description":"'host or attackerAsset' -'usesAddress'-> 'address'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["address"]
            },
            "outVType":{
              "required":true,
              "enum":["host", "attackerAsset"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasDNSName",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasDNSName",
          "description":"'address' -'hasDNSName'-> 'DNSName'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["DNSName"]
            },
            "outVType":{
              "required":true,
              "enum":["address"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasIP",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasIP",
          "description":"'address' -'hasIP'-> 'IP'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["IP"]
            },
            "outVType":{
              "required":true,
              "enum":["address"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasPort",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasPort",
          "description":"'address' -'hasPort'-> 'port'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["port"]
            },
            "outVType":{
              "required":true,
              "enum":["address"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/inAddressRange",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"inAddressRange",
          "description":"'IP' -'inAddressRange'-> 'addressRange'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["addressRange"]
            },
            "outVType":{
              "required":true,
              "enum":["IP"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasKnownService",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasKnownService",
          "description":"'port' -'hasKnownService'-> 'service'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["service"]
            },
            "outVType":{
              "required":true,
              "enum":["port"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/dstAddress",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"dstAddress",
          "description":"'flow' -'dstAddress'-> 'address'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["address"]
            },
            "outVType":{
              "required":true,
              "enum":["flow"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/srcAddress",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"srcAddress",
          "description":"'flow' -'srcAddress'-> 'address'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["address"]
            },
            "outVType":{
              "required":true,
              "enum":["flow"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/hasFlow",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"hasFlow",
          "description":"'software' -'hasFlow'-> 'flow'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["flow"]
            },
            "outVType":{
              "required":true,
              "enum":["software"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/exploits",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"exploits",
          "description":"'malware' -'exploits'-> 'vulnerability'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["vulnerability"]
            },
            "outVType":{
              "required":true,
              "enum":["malware"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/involvesMalware",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"involvesMalware",
          "description":"'attack' -'involvesMalware'-> 'malware'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["malware"]
            },
            "outVType":{
              "required":true,
              "enum":["attack"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/includesFlow",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"includesFlow",
          "description":"'attack' -'includesFlow'-> 'flow'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["flow"]
            },
            "outVType":{
              "required":true,
              "enum":["attack"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/associatedWith",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"associatedWith",
          "description":"'malware' -'associatedWith'-> 'attackerAsset'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["attackerAsset"]
            },
            "outVType":{
              "required":true,
              "enum":["malware"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/usedIn",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"usedIn",
          "description":"'attackerAsset' -'usedIn'-> 'attack'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["attack"]
            },
            "outVType":{
              "required":true,
              "enum":["attackerAsset"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/performs",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"performs",
          "description":"'attacker' -'performs'-> 'attack'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["attack"]
            },
            "outVType":{
              "required":true,
              "enum":["attacker"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/controls",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"controls",
          "description":"'attacker' -'controls'-> 'attackerAsset'",
          "properties":{
            "inVType":{
              "required":true,
              "enum":["attackerAsset"]
            },
            "outVType":{
              "required":true,
              "enum":["attacker"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/edges/sameAs",
          "extends": "gov.ornl.sava.graphson.normal/graph/edges/base",
          "title":"sameAs",
          "description":"indicates that a vertex may be the same as another; should include some confidence score",
          "properties":{
            "inVType":{
              "required":true
            },
            "outVType":{
              "required":true
            }
          }
        }
      ]
    },
    "vertices": {
      "title":"vertices",
      "description":"The list of vertices in this graph",
      "type":"array",
      "id": "gov.ornl.sava.stucco/graph/vertices",
      "required":false,
      "items":[
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/user",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"user",
          "description":"legitimate, authorized user of some system(s) \nA user owns, is assigned, and/or uses some hardware. \nA user has an associated account.",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["user"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/account",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"account",
          "description":"account on some specific system(s), either belonging to some specific user or a system account \nAll software runs as some account. \nAll accounts are associated with a user or users (such as system accounts.)",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["account"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/host",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"host",
          "description":"Any entity on the network, including PCs, routers, switches, virtual machines, etc.",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["host"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/software",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"software",
          "description":"Any software components on a system, including OSes, applications, services, and libraries.",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["software"]
            },
            "source":{
              "required":false
            },
            "description":{
              "required":false
            },
            "nvdId":{
              "required":false
            },
            "status":{
              "required":false
            },
            "modifiedDate":{
              "required":false
            },
            "part":{
              "required":false
            },
            "vendor":{
              "required":false
            },
            "product":{
              "required":false
            },
            "version":{
              "required":false
            },
            "update":{
              "required":false
            },
            "edition":{
              "required":false
            },
            "language":{
              "required":false
            },
            "processPath":{
              "required":false
            },
            "processPid":{
              "required":false
            },
            "processPpid":{
              "required":false
            },
            "processArgs":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/vulnerability",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"vulnerability",
          "description":"a flaw in some software, that can cause improper, unintended operation, and can potentially be exploited as part of an attack",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["vulnerability"]
            },
            "source":{
              "required":false
            },
            "comments":{
              "required":false
            },
            "description":{
              "required":false
            },
            "phase":{
              "required":false
            },
            "phaseDate":{
              "required":false
            },
            "references":{
              "required":false
            },
            "status":{
              "required":false
            },
            "publishedDate":{
              "required":false
            },
            "modifiedDate":{
              "required":false
            },
            "cweNumber":{
              "required":false
            },
            "cvssScore":{
              "required":false
            },
            "cvssDate":{
              "required":false
            },
            "accessVector":{
              "required":false
            },
            "accessComplexity":{
              "required":false
            },
            "accessAuthentication":{
              "required":false
            },
            "confidentialityImpact":{
              "required":false
            },
            "integrityImpact":{
              "required":false
            },
            "availabilityImpact":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/address",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"address",
          "description":"any address, either inside or outside of the network",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["address"]
            },
            "source":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/DNSName",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"DNSName",
          "description":"a DNS name (and possibly associated info - registration info, etc.)",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["DNSName"]
            },
            "source":{
              "required":false
            },
            "ns1":{
              "required":false
            },
            "ns2":{
              "required":false
            },
            "ns3":{
              "required":false
            },
            "ns4":{
              "required":false
            },
            "ns5":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/IP",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"IP",
          "description":"a specific IP address",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["IP"]
            },
            "source":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/port",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"port",
          "description":"a specific port",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["port"]
            },
            "source":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/addressRange",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"addressRange",
          "description":"address range",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["addressRange"]
            },
            "source":{
              "required":false
            },
            "startIP":{
              "required":false
            },
            "endIP":{
              "required":false
            },
            "startIPInt":{
              "required":false
            },
            "endIPInt":{
              "required":false
            },
            "countryCode":{
              "required":false
            },
            "countryName":{
              "required":false
            },
            "netname":{
              "required":false
            },
            "description":{
              "required":false
            },
            "asNum":{
              "required":false
            },
            "assignedBy":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/service",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"service",
          "description":"expected or actual service using some port",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["service"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/malware",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"malware",
          "description":"any malicious software.  This can refer to either a stored binary or a running instance. \nMalware can contain code to launch an exploit. \nMalware can itself be an asset that an attacker uses in future attacks (eg. a backdoor left on a compromised system.) or can automatically launch additional attacks on behalf of the original attacker. \nMalware can be hosted by or communicate with servers controlled by the attacker. \nMalware can contain code to load other malware. \nMalware can reuse components from other malware samples.",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["malware"]
            },
            "avName":{
              "required":false
            },
            "md5":{
              "required":false
            },
            "source":{
              "required":false
            },
            "malwareType":{
              "required":false
            },
            "discoveryDate":{
              "required":false
            },
            "shortDescription":{
              "required":false
            },
            "fullDescription":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/flow",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"flow",
          "description":"a flow of traffic between two addresses",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["flow"]
            },
            "source":{
              "required":false
            },
            "keyStrokeNStroke":{
              "required":false
            },
            "proto":{
              "required":false
            },
            "appBytes":{
              "required":false
            },
            "state":{
              "required":false
            },
            "startTime":{
              "required":false
            },
            "appByteRatio":{
              "required":false
            },
            "dir":{
              "required":false
            },
            "flags":{
              "required":false
            },
            "duration":{
              "required":false
            },
            "dstPkts":{
              "required":false
            },
            "srcPkts":{
              "required":false
            },
            "totalPkts":{
              "required":false
            },
            "totalBytes":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/attack",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"attack",
          "description":"\"a series of steps taken by an attacker to achieve an unauthorized result.\" [Howard & Longstaff, 98]",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["attack"]
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/attackerAsset",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"attackerAsset",
          "description":"some host or other asset (excluding malware) used by an attacker",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["attackerAsset"]
            },
            "source":{
              "required":false
            },
            "firstSeen":{
              "required":false
            },
            "lastSeen":{
              "required":false
            }
          }
        },
        {
          "id": "gov.ornl.sava.stucco/graph/vertices/attacker",
          "extends": "gov.ornl.sava.graphson.normal/graph/vertices/base",
          "title":"attacker",
          "description":"a known, suspected, or potential attacker",
          "properties":{
            "vertexType":{
              "required":true,
              "enum":["attacker"]
            }
          }
        }
      ]
    }
  }
}

